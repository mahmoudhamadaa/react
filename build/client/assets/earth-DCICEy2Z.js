import{r as l,j as le}from"./jsx-runtime-CbkKSL4Y.js";import{u as ut,i as Qe,g as dt,c as it,b as pt,m as mt,L as ht,t as ft}from"./heading-Bta2Mv7c.js";import{S as gt}from"./meta-Cl8y0TJ1.js";import{u as bt}from"./image-CCCNKC5S.js";import{u as yt}from"./useWindowSize-MDlHk0QV.js";import{R as Et,s as wt,E as _t,l as te,Q as et,e as He,O as Ge,u as tt,V as ce,v as Se,T as Re,w as Tt,H as Pe,F as Ye,x as Fe,b as je,y as St,z as Rt,B as Pt,I as Mt,W as xt,h as nt,o as vt,S as At,J as Lt,K as Dt,A as jt,D as kt,r as Ot,c as Ct,a as It,N as Ve,q as Nt,X as Ft,m as zt,Y as Ht,t as Yt,Z as Bt,_ as Ut}from"./three-CbWf-STM.js";import{c as ot}from"./clamp-e7DugykH.js";import{t as Gt}from"./throttle-BgiUmwhn.js";import{u as Te}from"./use-spring-BCf9a-zM.js";import"./components-fILOzQ25.js";import"./config-CVPt-aXh.js";import"./index-BRT4S8Nd.js";var Vt=Object.defineProperty,Zt=(m,r,y)=>r in m?Vt(m,r,{enumerable:!0,configurable:!0,writable:!0,value:y}):m[r]=y,s=(m,r,y)=>(Zt(m,typeof r!="symbol"?r+"":r,y),y);const ze=new Et,at=new wt,Xt=Math.cos(70*(Math.PI/180)),rt=(m,r)=>(m%r+r)%r;class Wt extends _t{constructor(r,y){super(),s(this,"object"),s(this,"domElement"),s(this,"enabled",!0),s(this,"target",new te),s(this,"minDistance",0),s(this,"maxDistance",1/0),s(this,"minZoom",0),s(this,"maxZoom",1/0),s(this,"minPolarAngle",0),s(this,"maxPolarAngle",Math.PI),s(this,"minAzimuthAngle",-1/0),s(this,"maxAzimuthAngle",1/0),s(this,"enableDamping",!1),s(this,"dampingFactor",.05),s(this,"enableZoom",!0),s(this,"zoomSpeed",1),s(this,"enableRotate",!0),s(this,"rotateSpeed",1),s(this,"enablePan",!0),s(this,"panSpeed",1),s(this,"screenSpacePanning",!0),s(this,"keyPanSpeed",7),s(this,"zoomToCursor",!1),s(this,"autoRotate",!1),s(this,"autoRotateSpeed",2),s(this,"reverseOrbit",!1),s(this,"reverseHorizontalOrbit",!1),s(this,"reverseVerticalOrbit",!1),s(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),s(this,"mouseButtons",{LEFT:Se.ROTATE,MIDDLE:Se.DOLLY,RIGHT:Se.PAN}),s(this,"touches",{ONE:Re.ROTATE,TWO:Re.DOLLY_PAN}),s(this,"target0"),s(this,"position0"),s(this,"zoom0"),s(this,"_domElementKeyEvents",null),s(this,"getPolarAngle"),s(this,"getAzimuthalAngle"),s(this,"setPolarAngle"),s(this,"setAzimuthalAngle"),s(this,"getDistance"),s(this,"getZoomScale"),s(this,"listenToKeyEvents"),s(this,"stopListenToKeyEvents"),s(this,"saveState"),s(this,"reset"),s(this,"update"),s(this,"connect"),s(this,"dispose"),s(this,"dollyIn"),s(this,"dollyOut"),s(this,"getScale"),s(this,"setScale"),this.object=r,this.domElement=y,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>w.phi,this.getAzimuthalAngle=()=>w.theta,this.setPolarAngle=t=>{let n=rt(t,2*Math.PI),i=w.phi;i<0&&(i+=2*Math.PI),n<0&&(n+=2*Math.PI);let M=Math.abs(n-i);2*Math.PI-M<M&&(n<i?n+=2*Math.PI:i+=2*Math.PI),k.phi=n-i,e.update()},this.setAzimuthalAngle=t=>{let n=rt(t,2*Math.PI),i=w.theta;i<0&&(i+=2*Math.PI),n<0&&(n+=2*Math.PI);let M=Math.abs(n-i);2*Math.PI-M<M&&(n<i?n+=2*Math.PI:i+=2*Math.PI),k.theta=n-i,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",$),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",$),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(J),e.update(),E=p.NONE},this.update=(()=>{const t=new te,n=new te(0,1,0),i=new et().setFromUnitVectors(r.up,n),M=i.clone().invert(),G=new te,pe=new et,Ee=2*Math.PI;return function(){const Je=e.object.position;i.setFromUnitVectors(r.up,n),M.copy(i).invert(),t.copy(Je).sub(e.target),t.applyQuaternion(i),w.setFromVector3(t),e.autoRotate&&E===p.NONE&&u(L()),e.enableDamping?(w.theta+=k.theta*e.dampingFactor,w.phi+=k.phi*e.dampingFactor):(w.theta+=k.theta,w.phi+=k.phi);let me=e.minAzimuthAngle,he=e.maxAzimuthAngle;isFinite(me)&&isFinite(he)&&(me<-Math.PI?me+=Ee:me>Math.PI&&(me-=Ee),he<-Math.PI?he+=Ee:he>Math.PI&&(he-=Ee),me<=he?w.theta=Math.max(me,Math.min(he,w.theta)):w.theta=w.theta>(me+he)/2?Math.max(me,w.theta):Math.min(he,w.theta)),w.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,w.phi)),w.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(re,e.dampingFactor):e.target.add(re),e.zoomToCursor&&h||e.object.isOrthographicCamera?w.radius=O(w.radius):w.radius=O(w.radius*z),t.setFromSpherical(w),t.applyQuaternion(M),Je.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(k.theta*=1-e.dampingFactor,k.phi*=1-e.dampingFactor,re.multiplyScalar(1-e.dampingFactor)):(k.set(0,0,0),re.set(0,0,0));let Ae=!1;if(e.zoomToCursor&&h){let Le=null;if(e.object instanceof He&&e.object.isPerspectiveCamera){const De=t.length();Le=O(De*z);const Ne=De-Le;e.object.position.addScaledVector(oe,Ne),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const De=new te(o.x,o.y,0);De.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/z)),e.object.updateProjectionMatrix(),Ae=!0;const Ne=new te(o.x,o.y,0);Ne.unproject(e.object),e.object.position.sub(Ne).add(De),e.object.updateMatrixWorld(),Le=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Le!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Le).add(e.object.position):(ze.origin.copy(e.object.position),ze.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(ze.direction))<Xt?r.lookAt(e.target):(at.setFromNormalAndCoplanarPoint(e.object.up,e.target),ze.intersectPlane(at,e.target))))}else e.object instanceof Ge&&e.object.isOrthographicCamera&&(Ae=z!==1,Ae&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/z)),e.object.updateProjectionMatrix()));return z=1,h=!1,Ae||G.distanceToSquared(e.object.position)>V||8*(1-pe.dot(e.object.quaternion))>V?(e.dispatchEvent(J),G.copy(e.object.position),pe.copy(e.object.quaternion),Ae=!1,!0):!1}})(),this.connect=t=>{e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",ve),e.domElement.addEventListener("pointerdown",Z),e.domElement.addEventListener("pointercancel",d),e.domElement.addEventListener("wheel",ye)},this.dispose=()=>{var t,n,i,M,G,pe;e.domElement&&(e.domElement.style.touchAction="auto"),(t=e.domElement)==null||t.removeEventListener("contextmenu",ve),(n=e.domElement)==null||n.removeEventListener("pointerdown",Z),(i=e.domElement)==null||i.removeEventListener("pointercancel",d),(M=e.domElement)==null||M.removeEventListener("wheel",ye),(G=e.domElement)==null||G.ownerDocument.removeEventListener("pointermove",S),(pe=e.domElement)==null||pe.ownerDocument.removeEventListener("pointerup",d),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",$)};const e=this,J={type:"change"},R={type:"start"},c={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let E=p.NONE;const V=1e-6,w=new tt,k=new tt;let z=1;const re=new te,v=new ce,j=new ce,X=new ce,H=new ce,B=new ce,C=new ce,f=new ce,ne=new ce,se=new ce,oe=new te,o=new ce;let h=!1;const a=[],g={};function L(){return 2*Math.PI/60/60*e.autoRotateSpeed}function T(){return Math.pow(.95,e.zoomSpeed)}function u(t){e.reverseOrbit||e.reverseHorizontalOrbit?k.theta+=t:k.theta-=t}function b(t){e.reverseOrbit||e.reverseVerticalOrbit?k.phi+=t:k.phi-=t}const _=(()=>{const t=new te;return function(i,M){t.setFromMatrixColumn(M,0),t.multiplyScalar(-i),re.add(t)}})(),ie=(()=>{const t=new te;return function(i,M){e.screenSpacePanning===!0?t.setFromMatrixColumn(M,1):(t.setFromMatrixColumn(M,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(i),re.add(t)}})(),ae=(()=>{const t=new te;return function(i,M){const G=e.domElement;if(G&&e.object instanceof He&&e.object.isPerspectiveCamera){const pe=e.object.position;t.copy(pe).sub(e.target);let Ee=t.length();Ee*=Math.tan(e.object.fov/2*Math.PI/180),_(2*i*Ee/G.clientHeight,e.object.matrix),ie(2*M*Ee/G.clientHeight,e.object.matrix)}else G&&e.object instanceof Ge&&e.object.isOrthographicCamera?(_(i*(e.object.right-e.object.left)/e.object.zoom/G.clientWidth,e.object.matrix),ie(M*(e.object.top-e.object.bottom)/e.object.zoom/G.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function W(t){e.object instanceof He&&e.object.isPerspectiveCamera||e.object instanceof Ge&&e.object.isOrthographicCamera?z=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function U(t){W(z/t)}function ue(t){W(z*t)}function I(t){if(!e.zoomToCursor||!e.domElement)return;h=!0;const n=e.domElement.getBoundingClientRect(),i=t.clientX-n.left,M=t.clientY-n.top,G=n.width,pe=n.height;o.x=i/G*2-1,o.y=-(M/pe)*2+1,oe.set(o.x,o.y,1).unproject(e.object).sub(e.object.position).normalize()}function O(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function Q(t){v.set(t.clientX,t.clientY)}function we(t){I(t),f.set(t.clientX,t.clientY)}function ge(t){H.set(t.clientX,t.clientY)}function _e(t){j.set(t.clientX,t.clientY),X.subVectors(j,v).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(u(2*Math.PI*X.x/n.clientHeight),b(2*Math.PI*X.y/n.clientHeight)),v.copy(j),e.update()}function be(t){ne.set(t.clientX,t.clientY),se.subVectors(ne,f),se.y>0?U(T()):se.y<0&&ue(T()),f.copy(ne),e.update()}function Me(t){B.set(t.clientX,t.clientY),C.subVectors(B,H).multiplyScalar(e.panSpeed),ae(C.x,C.y),H.copy(B),e.update()}function ke(t){I(t),t.deltaY<0?ue(T()):t.deltaY>0&&U(T()),e.update()}function Be(t){let n=!1;switch(t.code){case e.keys.UP:ae(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:ae(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:ae(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:ae(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function Oe(){if(a.length==1)v.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),n=.5*(a[0].pageY+a[1].pageY);v.set(t,n)}}function P(){if(a.length==1)H.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),n=.5*(a[0].pageY+a[1].pageY);H.set(t,n)}}function x(){const t=a[0].pageX-a[1].pageX,n=a[0].pageY-a[1].pageY,i=Math.sqrt(t*t+n*n);f.set(0,i)}function D(){e.enableZoom&&x(),e.enablePan&&P()}function q(){e.enableZoom&&x(),e.enableRotate&&Oe()}function K(t){if(a.length==1)j.set(t.pageX,t.pageY);else{const i=Ue(t),M=.5*(t.pageX+i.x),G=.5*(t.pageY+i.y);j.set(M,G)}X.subVectors(j,v).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(u(2*Math.PI*X.x/n.clientHeight),b(2*Math.PI*X.y/n.clientHeight)),v.copy(j)}function F(t){if(a.length==1)B.set(t.pageX,t.pageY);else{const n=Ue(t),i=.5*(t.pageX+n.x),M=.5*(t.pageY+n.y);B.set(i,M)}C.subVectors(B,H).multiplyScalar(e.panSpeed),ae(C.x,C.y),H.copy(B)}function A(t){const n=Ue(t),i=t.pageX-n.x,M=t.pageY-n.y,G=Math.sqrt(i*i+M*M);ne.set(0,G),se.set(0,Math.pow(ne.y/f.y,e.zoomSpeed)),U(se.y),f.copy(ne)}function de(t){e.enableZoom&&A(t),e.enablePan&&F(t)}function Y(t){e.enableZoom&&A(t),e.enableRotate&&K(t)}function Z(t){var n,i;e.enabled!==!1&&(a.length===0&&((n=e.domElement)==null||n.ownerDocument.addEventListener("pointermove",S),(i=e.domElement)==null||i.ownerDocument.addEventListener("pointerup",d)),Ie(t),t.pointerType==="touch"?xe(t):N(t))}function S(t){e.enabled!==!1&&(t.pointerType==="touch"?Ce(t):ee(t))}function d(t){var n,i,M;lt(t),a.length===0&&((n=e.domElement)==null||n.releasePointerCapture(t.pointerId),(i=e.domElement)==null||i.ownerDocument.removeEventListener("pointermove",S),(M=e.domElement)==null||M.ownerDocument.removeEventListener("pointerup",d)),e.dispatchEvent(c),E=p.NONE}function N(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case Se.DOLLY:if(e.enableZoom===!1)return;we(t),E=p.DOLLY;break;case Se.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ge(t),E=p.PAN}else{if(e.enableRotate===!1)return;Q(t),E=p.ROTATE}break;case Se.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;Q(t),E=p.ROTATE}else{if(e.enablePan===!1)return;ge(t),E=p.PAN}break;default:E=p.NONE}E!==p.NONE&&e.dispatchEvent(R)}function ee(t){if(e.enabled!==!1)switch(E){case p.ROTATE:if(e.enableRotate===!1)return;_e(t);break;case p.DOLLY:if(e.enableZoom===!1)return;be(t);break;case p.PAN:if(e.enablePan===!1)return;Me(t);break}}function ye(t){e.enabled===!1||e.enableZoom===!1||E!==p.NONE&&E!==p.ROTATE||(t.preventDefault(),e.dispatchEvent(R),ke(t),e.dispatchEvent(c))}function $(t){e.enabled===!1||e.enablePan===!1||Be(t)}function xe(t){switch($e(t),a.length){case 1:switch(e.touches.ONE){case Re.ROTATE:if(e.enableRotate===!1)return;Oe(),E=p.TOUCH_ROTATE;break;case Re.PAN:if(e.enablePan===!1)return;P(),E=p.TOUCH_PAN;break;default:E=p.NONE}break;case 2:switch(e.touches.TWO){case Re.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;D(),E=p.TOUCH_DOLLY_PAN;break;case Re.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;q(),E=p.TOUCH_DOLLY_ROTATE;break;default:E=p.NONE}break;default:E=p.NONE}E!==p.NONE&&e.dispatchEvent(R)}function Ce(t){switch($e(t),E){case p.TOUCH_ROTATE:if(e.enableRotate===!1)return;K(t),e.update();break;case p.TOUCH_PAN:if(e.enablePan===!1)return;F(t),e.update();break;case p.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;de(t),e.update();break;case p.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Y(t),e.update();break;default:E=p.NONE}}function ve(t){e.enabled!==!1&&t.preventDefault()}function Ie(t){a.push(t)}function lt(t){delete g[t.pointerId];for(let n=0;n<a.length;n++)if(a[n].pointerId==t.pointerId){a.splice(n,1);return}}function $e(t){let n=g[t.pointerId];n===void 0&&(n=new ce,g[t.pointerId]=n),n.set(t.pageX,t.pageY)}function Ue(t){const n=t.pointerId===a[0].pointerId?a[1]:a[0];return g[n.pointerId]}this.dollyIn=(t=T())=>{ue(t),e.update()},this.dollyOut=(t=T())=>{U(t),e.update()},this.getScale=()=>z,this.setScale=t=>{W(t),e.update()},this.getZoomScale=()=>T(),y!==void 0&&this.connect(y),this.update()}}class qt extends Tt{constructor(r){super(r),this.type=Pe}parse(r){const c=function(o,h){switch(o){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(h||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(h||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(h||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(h||""))}},w=`
`,k=function(o,h,a){h=h||1024;let L=o.pos,T=-1,u=0,b="",_=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));for(;0>(T=_.indexOf(w))&&u<h&&L<o.byteLength;)b+=_,u+=_.length,L+=128,_+=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));return-1<T?(o.pos+=u+T+1,b+_.slice(0,T)):!1},z=function(o){const h=/^#\?(\S+)/,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,g=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*FORMAT=(\S+)\s*$/,T=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let b,_;for((o.pos>=o.byteLength||!(b=k(o)))&&c(1,"no header found"),(_=b.match(h))||c(3,"bad initial token"),u.valid|=1,u.programtype=_[1],u.string+=b+`
`;b=k(o),b!==!1;){if(u.string+=b+`
`,b.charAt(0)==="#"){u.comments+=b+`
`;continue}if((_=b.match(a))&&(u.gamma=parseFloat(_[1])),(_=b.match(g))&&(u.exposure=parseFloat(_[1])),(_=b.match(L))&&(u.valid|=2,u.format=_[1]),(_=b.match(T))&&(u.valid|=4,u.height=parseInt(_[1],10),u.width=parseInt(_[2],10)),u.valid&2&&u.valid&4)break}return u.valid&2||c(3,"missing format specifier"),u.valid&4||c(3,"missing image size specifier"),u},re=function(o,h,a){const g=h;if(g<8||g>32767||o[0]!==2||o[1]!==2||o[2]&128)return new Uint8Array(o);g!==(o[2]<<8|o[3])&&c(3,"wrong scanline width");const L=new Uint8Array(4*h*a);L.length||c(4,"unable to allocate buffer space");let T=0,u=0;const b=4*g,_=new Uint8Array(4),ie=new Uint8Array(b);let ae=a;for(;ae>0&&u<o.byteLength;){u+4>o.byteLength&&c(1),_[0]=o[u++],_[1]=o[u++],_[2]=o[u++],_[3]=o[u++],(_[0]!=2||_[1]!=2||(_[2]<<8|_[3])!=g)&&c(3,"bad rgbe scanline format");let W=0,U;for(;W<b&&u<o.byteLength;){U=o[u++];const I=U>128;if(I&&(U-=128),(U===0||W+U>b)&&c(3,"bad scanline data"),I){const O=o[u++];for(let Q=0;Q<U;Q++)ie[W++]=O}else ie.set(o.subarray(u,u+U),W),W+=U,u+=U}const ue=g;for(let I=0;I<ue;I++){let O=0;L[T]=ie[I+O],O+=g,L[T+1]=ie[I+O],O+=g,L[T+2]=ie[I+O],O+=g,L[T+3]=ie[I+O],T+=4}ae--}return L},v=function(o,h,a,g){const L=o[h+3],T=Math.pow(2,L-128)/255;a[g+0]=o[h+0]*T,a[g+1]=o[h+1]*T,a[g+2]=o[h+2]*T,a[g+3]=1},j=function(o,h,a,g){const L=o[h+3],T=Math.pow(2,L-128)/255;a[g+0]=Fe.toHalfFloat(Math.min(o[h+0]*T,65504)),a[g+1]=Fe.toHalfFloat(Math.min(o[h+1]*T,65504)),a[g+2]=Fe.toHalfFloat(Math.min(o[h+2]*T,65504)),a[g+3]=Fe.toHalfFloat(1)},X=new Uint8Array(r);X.pos=0;const H=z(X),B=H.width,C=H.height,f=re(X.subarray(X.pos),B,C);let ne,se,oe;switch(this.type){case Ye:oe=f.length/4;const o=new Float32Array(oe*4);for(let a=0;a<oe;a++)v(f,a*4,o,a*4);ne=o,se=Ye;break;case Pe:oe=f.length/4;const h=new Uint16Array(oe*4);for(let a=0;a<oe;a++)j(f,a*4,h,a*4);ne=h,se=Pe;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:B,height:C,data:ne,header:H.string,gamma:H.gamma,exposure:H.exposure,type:se}}setDataType(r){return this.type=r,this}load(r,y,e,J){function R(c,p){switch(c.type){case Ye:case Pe:"colorSpace"in c?c.colorSpace="srgb-linear":c.encoding=3e3,c.minFilter=je,c.magFilter=je,c.generateMipmaps=!1,c.flipY=!0;break}y&&y(c,p)}return super.load(r,R,e,J)}}class Kt extends St{constructor(r){super(r),this.hdrLoader=new qt,this.type=Pe}load(r,y,e,J){typeof r=="string"?r=[r]:Array.isArray(r)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(r),r=y,y=e,e=J,J=arguments[4]);const R=new Rt;switch(R.type=this.type,R.type){case Ye:case Pe:"colorSpace"in R?R.colorSpace="srgb-linear":R.encoding=3e3,R.minFilter=je,R.magFilter=je,R.generateMipmaps=!1;break}const c=this;let p=0;function E(V,w,k,z){new Pt(c.manager).setPath(c.path).setResponseType("arraybuffer").setWithCredentials(c.withCredentials).load(r[V],function(re){p++;const v=c.hdrLoader.parse(re);if(v){if(v.data!==void 0){const j=new Mt(v.data,v.width,v.height);j.type=R.type,"colorSpace"in j?j.colorSpace=R.SRGBColorSpace:j.encoding=R.encoding,j.format=R.format,j.minFilter=R.minFilter,j.magFilter=R.magFilter,j.generateMipmaps=R.generateMipmaps,R.images[V]=j}p===6&&(R.needsUpdate=!0,w&&w(R))}},k,z)}for(let V=0;V<r.length;V++)E(V,y,e,J);return R}setDataType(r){return this.type=r,this.hdrLoader.setDataType(r),this}}const $t="/assets/earth-DvZudj9K.glb",Jt="/assets/milkyway-nx-Ds_hwpSC.hdr",Qt="/assets/milkyway-ny-BqhFvupA.hdr",en="/assets/milkyway-nz-D6l6T-pv.hdr",tn="/assets/milkyway-px-BjIdbMt0.hdr",nn="/assets/milkyway-py-BD6pEbZF.hdr",on="/assets/milkyway-pz-Bx3WFS88.hdr",an="/assets/milkyway-Vkpv7LbT.jpg",rn="_earth_4tqjk_1",sn="_loader_4tqjk_15",cn="_viewport_4tqjk_43",ln="_canvas_4tqjk_65",un="_labels_4tqjk_103",dn="_label_4tqjk_103",pn="_vignette_4tqjk_163",mn="_sections_4tqjk_187",hn="_section_4tqjk_187",fe={earth:rn,loader:sn,viewport:cn,canvas:ln,labels:un,label:dn,vignette:pn,sections:mn,section:hn},Ke={x:0,y:0,z:2},Ze=(m,r,y)=>m+y*(r-m),st=m=>Object.keys(m).map(r=>parseFloat(Math.round(m[r]*100)/100).toFixed(2)).join(", "),Xe=m=>!m||!m.camera?Ke:{x:m.camera[0],y:m.camera[1],z:m.camera[2]},fn=(m,r)=>{const y=(e=0)=>Math.round((e+Number.EPSILON)*100)/100;return y(m==null?void 0:m.x)===y(r==null?void 0:r.x)&&y(m==null?void 0:m.y)===y(r==null?void 0:r.y)&&y(m==null?void 0:m.z)===y(r==null?void 0:r.z)},We={stiffness:80,damping:40,mass:2,restSpeed:.001,restDelta:.001},qe={stiffness:40,damping:30,mass:2,restSpeed:.001,restDelta:.001},gn={stiffness:40,damping:30},ct=l.createContext({}),Ln=({position:m=[0,0,0],scale:r=1,hideMeshes:y=[],labels:e=[],className:J,children:R})=>{const[c,p]=l.useState(!1),[E,V]=l.useState(!1),[w,k]=l.useState(!1),[z,re]=l.useState(!1),v=l.useRef([]),j=l.useRef(),X=l.useRef(),H=l.useRef(),B=l.useRef(),C=l.useRef(),f=l.useRef(),ne=l.useRef(),se=l.useRef(),oe=l.useRef(),o=l.useRef(),h=l.useRef(),a=l.useRef(),g=bt(H),L=l.useRef(),T=l.useRef(Xe(v.current[0])),u=l.useRef([]),b=l.useRef(),_=l.useRef(),ie=l.useRef(),ae=l.useRef(),{width:W,height:U}=yt(),ue=ut(),I=Te(0,We),O=Te(0,We),Q=Te(0,We),we=Te(0,qe),ge=Te(0,qe),_e=Te(0,qe),be=Te(0,gn),Me=l.useCallback(()=>{if(!g){cancelAnimationFrame(L.current);return}L.current=requestAnimationFrame(Me);const P=ne.current.getDelta();a.current.update(P),b.current.update(),C.current.render(B.current,f.current),u.current.forEach(x=>{const{element:D,position:q,sprite:K}=x,F=new te(...q),A=f.current.position.distanceTo(o.current.position),Y=f.current.position.distanceTo(K.position)>A;F.project(f.current),F.x=Math.round((.5+F.x/2)*window.innerWidth),F.y=Math.round((.5-F.y/2)*window.innerHeight),D.style.setProperty("--posX",Qe(F.x)),D.style.setProperty("--posY",Qe(F.y)),Y?D.dataset.occluded=!0:D.dataset.occluded=!1})},[g]);l.useEffect(()=>{ae.current=!0;const{innerWidth:P,innerHeight:x}=window;C.current=new xt({canvas:H.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),C.current.setPixelRatio(1),C.current.outputColorSpace=nt,C.current.toneMapping=vt,f.current=new He(54,P/x,.1,100),f.current.position.x=T.current.x,f.current.position.y=T.current.y,f.current.position.z=T.current.z,f.current.lookAt(0,0,0),I.set(f.current.position.x,!1),O.set(f.current.position.y,!1),Q.set(f.current.position.z,!1),B.current=new At,ne.current=new Lt,oe.current=new Dt;const D=new jt(2236962,.05),q=new kt(16777215,1.5);q.position.set(3,0,1);const K=[D,q];return K.forEach(F=>B.current.add(F)),b.current=new Wt(f.current,H.current),b.current.enableZoom=!1,b.current.enablePan=!1,b.current.enableDamping=!1,b.current.rotateSpeed=.5,()=>{ae.current=!1,cancelAnimationFrame(L.current),Ot(K),Ct(B.current),It(C.current)}},[]),l.useEffect(()=>{const P=()=>{V(!0),I.stop(),O.stop(),Q.stop()},x=()=>{I.set(f.current.position.x,!1),O.set(f.current.position.y,!1),Q.set(f.current.position.z,!1),V(!1)};return b.current.addEventListener("start",P),b.current.addEventListener("end",x),()=>{b.current.removeEventListener("start",P),b.current.removeEventListener("end",x)}},[I,O,Q]),l.useEffect(()=>{if(!c)return;const P=Ve("Chunk",o.current),x=Ve("Atmosphere",o.current),D=(d,N)=>{f.current.position[d]=N},q=I.on("change",d=>D("x",d)),K=O.on("change",d=>D("y",d)),F=Q.on("change",d=>D("z",d)),A=(d,N)=>{P.position[d]=N},de=we.on("change",d=>A("x",d)),Y=ge.on("change",d=>A("y",d)),Z=_e.on("change",d=>A("z",d)),S=be.on("change",d=>{x.material.opacity=d});return()=>{q(),K(),F(),de(),Y(),Z(),S()}},[I,O,Q,we,ge,_e,c,be]),l.useEffect(()=>{W<=dt.tablet&&(b.current.enabled=!1)},[W]),l.useEffect(()=>{if(c)return;const P=new Kt,x=new Nt(C.current);x.compileCubemapShader();const D=async()=>{const A=await zt.loadAsync($t);o.current=A.scene,h.current=A.animations,a.current=new Ht(o.current),a.current.timeScale=.1,o.current.traverse(async de=>{const{material:Y,name:Z}=de;Z==="Atmosphere"&&(Y.alphaMap=Y.map),Y&&await C.current.initTexture(Y)}),o.current.position.x=m[0],o.current.position.y=m[1],o.current.position.z=m[2],o.current.scale.x=r,o.current.scale.y=r,o.current.scale.z=r},q=async()=>{const A=await P.loadAsync([Jt,Qt,en,tn,nn,on]);A.magFilter=je,_.current=x.fromCubemap(A),x.dispose(),await C.current.initTexture(_.current.texture)},K=async()=>{const A=await Yt.loadAsync(an);A.mapping=Bt,A.colorSpace=nt,B.current.background=A,await C.current.initTexture(A)},F=async()=>{await Promise.all([K(),q(),D()]),o.current.traverse(({material:A})=>{A&&(A.envMap=_.current.texture,A.needsUpdate=!0)}),ae.current&&p(!0)};l.startTransition(()=>{F(),setTimeout(()=>{re(!0)},1e3)})},[c,m,r]),l.useEffect(()=>(c&&!ie.current&&(B.current.add(o.current),ie.current=!0),c&&g&&(k(!0),Me()),()=>{cancelAnimationFrame(L.current)}),[Me,g,c]),l.useEffect(()=>{c&&(X.current.innerHTML="",u.current=e.map(P=>{const x=document.createElement("div");x.classList.add(fe.label),x.dataset.hidden=!0,x.style.setProperty("--delay",`${P.delay||0}ms`),x.textContent=P.text,X.current.appendChild(x);const D=new Ft;return D.position.set(...P.position),D.scale.set(60,60,1),{element:x,...P,sprite:D}}))},[e,c]),l.useEffect(()=>{C.current.setSize(W,U),f.current.aspect=W/U,f.current.updateProjectionMatrix()},[W,U]),l.useEffect(()=>{const P=H.current,x=D=>{const{innerWidth:q,innerHeight:K}=window,F=st(f.current.position);console.info({cameraPosition:F}),se.current=new ce(D.clientX/q*2-1,-(D.clientY/K)*2+1),oe.current.setFromCamera(se.current,f.current);const A=oe.current.intersectObjects(B.current.children,!0);if(A.length>0){const de=st(A[0].point);console.info({clickPosition:de})}};return()=>{P.removeEventListener("click",x)}},[]);const ke=l.useCallback(()=>{if(!j.current)return;const{offsetTop:P}=j.current,{innerHeight:x}=window,D=window.scrollY-P;let q;const K=Y=>{const Z=v.current[Y].meshes;o.current.traverse(S=>{const{name:d}=S,N=Ve("Chunk",o.current),ee=Z==null?void 0:Z.includes(d),ye=y==null?void 0:y.includes(d);if(ee)if(d==="Atmosphere")S.visible=!0,be.set(1);else if(d==="Chunk"){const $=new te(-.4,.4,.4);S.visible=!0,ue?S.position.set(...$.toArray()):(we.set($.x),ge.set($.y),_e.set($.z))}else d==="EarthFull"&&N.visible?S.visible=!1:S.visible=!0;else if(ye&&!ee)if(d==="Atmosphere")be.set(0);else if(d==="Chunk"){const $=new te(0,0,0);fn($,N.position)&&(S.visible=!1),we.set($.x),ge.set($.y),_e.set($.z)}else d==="EarthPartial"&&N.visible?S.visible=!0:S.visible=!1})},F=Y=>{const Z=v.current[Y].animations;ue||(h.current.forEach((S,d)=>{Z.find(N=>N.includes(d.toString()))||a.current.clipAction(S).reset().stop()}),h.current.length&&v.current[Y].animations&&Z.forEach(S=>{const d=S.split(":"),N=h.current[Number(d[0])],ee=a.current.clipAction(N);(!d[1]||d[1]!=="loop")&&(ee.clampWhenFinished=!0,ee.loop=Ut),ee.play()}))},A=Y=>{u.current.forEach(S=>{S.hidden&&(S.element.dataset.hidden=!0,S.element.setAttribute("aria-hidden",!0))}),v.current[Y].labels.forEach(S=>{u.current.filter(N=>N.text===S).forEach(N=>{N.element.dataset.hidden=!1,N.element.setAttribute("aria-hidden",!1)})})};requestAnimationFrame(()=>{const Y=v.current.length-1,Z=Math.floor(D/x),S=ot(Z,0,Y),d=v.current[S],N=v.current[S+1],ee=Xe(d)||Ke,ye=Xe(N)||Ke,$=(D-x*S)/x,xe=ot($,0,1),Ce=Ze(ee.x,ye.x,xe),ve=Ze(ee.y,ye.y,xe),Ie=Ze(ee.z,ye.z,xe);if(q!==ee&&v.current.length&&d&&(K(S),F(S),A(S)),q=ee,!E){if(ue){f.current.position.set(Ce,ve,Ie);return}I.set(Ce),O.set(ve),Q.set(Ie)}})},[I,O,Q,we,ge,_e,E,y,be,ue]);l.useEffect(()=>{const P=Gt(ke,100);return c&&g&&window.addEventListener("scroll",P),()=>{window.removeEventListener("scroll",P)}},[ke,g,c,be]);const Be=l.useCallback(P=>{v.current=[...v.current,P]},[]),Oe=l.useCallback(P=>{v.current=v.current.filter(x=>x!==P)},[]);return le.jsx(ct.Provider,{value:{registerSection:Be,unregisterSection:Oe},children:le.jsxs("div",{className:it(fe.earth,J),ref:j,children:[le.jsxs("div",{className:fe.viewport,children:[le.jsx("canvas",{className:fe.canvas,"data-visible":c&&w,"data-grabbing":E,ref:H}),le.jsx("div",{className:fe.labels,"aria-live":"polite",ref:X}),le.jsx("div",{className:fe.vignette})]}),le.jsx("div",{className:fe.sections,children:R}),le.jsx(pt,{unmount:!0,in:!c&&z,timeout:mt(ft.base.durationL),children:P=>le.jsx(gt,{className:fe.loader,"data-visible":P,children:le.jsx(ht,{})})})]})})},Dn=l.memo(({children:m,scrim:r,scrimReverse:y,className:e,camera:J=[0,0,0],animations:R=[],meshes:c=[],labels:p=[]})=>{const{registerSection:E,unregisterSection:V}=l.useContext(ct),w=l.useRef(),k=JSON.stringify(R)+JSON.stringify(J)+JSON.stringify(p)+JSON.stringify(c);return l.useEffect(()=>{const z={camera:J,animations:R,meshes:c,labels:p,sectionRef:w};return E(z),()=>{V(z)}},[k,E,V]),le.jsx("div",{className:it(fe.section,e),"data-scrim":r,"data-scrim-reverse":y,ref:w,children:m})});export{Ln as Earth,Dn as EarthSection};
